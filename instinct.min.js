(function(){function n(n){var t=r.exec(""+n.prototype.constructor),e={};return t[1].length>0&&t[1].replace(/\s/g,"").split(",").forEach(function(n,t){e[n]=t}),e}function t(t,r){t=t||{},r=r||{};var c={},o={logic:t,facts:r,process:c};return o.exec=function(f,u){function i(n){if(arguments.length>1&&n&&(p=-1,c[f].apply(o,arguments)),!p--){var t=[];for(var e in s)t[s[e]]=g[e]?g[e]:r[e];a.apply(g,t)}}var a,l=c[f];if("function"!=typeof f){if(r[f])return u(null,r[f]);if(l)return c[f]=function(){l.apply(o,arguments),u&&u.apply(o,arguments)},o;if(a=t[f],"function"!=typeof a)return void 0!==a?u(null,r[f]=a):u({ref:f,err:"Not defined"})}else a=f;var s=n(a),p=0;c[f]=function(n,t){delete c[f],n||(r[f]=t),n&&!n.ref&&(n={ref:f,err:n}),u&&u.call(o,n,t)};var g={callback:function(){this.callback=e,c[f].apply(o,arguments)},fact:function(n){this.callback(null,n)},error:function(n){this.callback(n)},facts:o.facts};return Object.keys(s).forEach(function(n){void 0!==r[n]||n in g||(p++,o.exec(n,i))}),i(),o},o.as=function(n){return c[n]=e,function(t,e){r[n]=2==arguments.length?e:t,console.log(r[n]),c[n](),delete c[n]}},o}function e(){}"undefined"==typeof module?self.instinct=t:module.exports=t,t.version="0.0.3";var r=/function.*?\((.*?)\).*/})();