(function(){function n(n){var t=c.exec(""+n.prototype.constructor),e={};return t[1].length>0&&t[1].replace(/\s/g,"").split(",").forEach(function(n,t){e[n]=t}),e}function t(t,c){t=t||{},c=c||{};var r={},o={logic:t,facts:c,process:r};return o.exec=function(u,a){function f(n){arguments.length>1&&n&&(g=-1,r[u].apply(o,arguments)),g--||l()}function l(){var n={callback:function(){this.callback=e,r[u].apply(o,arguments)},fact:function(n){this.callback(null,n)},error:function(n){this.callback(n,null)},facts:o.facts},t=[];for(var a in p)t[p[a]]=n[a]?n[a]:c[a];i.apply(n,t)}var i,s;if("function"!=typeof u){if(c[u])return a(null,c[u]);if(s=r[u])return r[u]=function(){s.apply(o,arguments),a&&a.apply(o,arguments)};if(i=t[u],"function"!=typeof i)return a(null,c[u]=i)}else i=u;var p=n(i),g=0;return r[u]=function(n,t){delete r[u],n||(c[u]=t),n&&!n.ref&&(n={ref:u,err:n}),a&&a.call(o,n,t)},Object.keys(p).forEach(function(n){void 0!==c[n]||n in["callback","fact","error","facts"]||(g++,o.exec(n,f))}),f(),o},o.as=function(n){return r[n]=e,function(t,e){c[n]=2==arguments.length?e:t,console.log(c[n]),r[n](),delete r[n]}},o}function e(){}"undefined"==typeof module?self.instinct=t:module.exports=t,t.version="0.0.3";var c=/function.*?\((.*?)\).*/})();