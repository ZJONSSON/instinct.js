(function(){function n(n){var t=r.exec(""+n.prototype.constructor),e={};return t[1].length>0&&t[1].replace(/\s/g,"").split(",").forEach(function(n,t){e[n]=t}),e}function t(t,r){t=t||{},r=r||{};var c={},o={logic:t,facts:r,process:c};return o.exec=function(u,f){function a(n){if(arguments.length>1&&n&&(p=-1,c[u].apply(o,arguments)),!p--){var t=[];for(var e in s)t[s[e]]=g[e]?g[e]:r[e];i.apply(g,t)}}var i,l;if("function"!=typeof u){if(r[u])return f(null,r[u]);if(l=c[u])return c[u]=function(){l.apply(o,arguments),f&&f.apply(o,arguments)};if(i=t[u],"function"!=typeof i)return f(null,r[u]=i)}else i=u;var s=n(i),p=0;c[u]=function(n,t){delete c[u],n||(r[u]=t),n&&!n.ref&&(n={ref:u,err:n}),f&&f.call(o,n,t)};var g={callback:function(){this.callback=e,c[u].apply(o,arguments)},fact:function(n){this.callback(null,n)},error:function(n){this.callback(n)},facts:o.facts};return Object.keys(s).forEach(function(n){void 0!==r[n]||n in g||(p++,o.exec(n,a))}),a(),o},o.as=function(n){return c[n]=e,function(t,e){r[n]=2==arguments.length?e:t,console.log(r[n]),c[n](),delete c[n]}},o}function e(){}"undefined"==typeof module?self.instinct=t:module.exports=t,t.version="0.0.3";var r=/function.*?\((.*?)\).*/})();